# 2.4. Arquitectura de Vistas: Layouts y Herencia en Blade
Los layouts son la columna vertebral de cualquier aplicaciÃ³n web profesional, permitiendo mantener una estructura visual consistente y realizar cambios globales desde un Ãºnico punto de control.

**Â¿Por quÃ© son esenciales los layouts?** En aplicaciones reales, todas las pÃ¡ginas comparten elementos estructurales comunes: la barra de navegaciÃ³n, el footer, los enlaces a hojas de estilo CSS y scripts JavaScript, los meta tags de SEO. Sin un sistema de layouts, cambiar algo tan simple como el logo de la empresa requerirÃ­a editar manualmente cientos de archivos individuales.

Los layouts eliminan esta pesadilla, centralizando la estructura comÃºn y permitiendo que cada pÃ¡gina se enfoque Ãºnicamente en su contenido especÃ­fico.

???+examplelaravel "AnalogÃ­a: FÃ¡brica de Aviones con 100 Unidades del Mismo Modelo"

    **Imagina que Boeing fabrica 100 aviones del modelo 737.**

    * âœˆï¸ **El DiseÃ±o Base (Layout)** Todos tienen: fuselaje, alas, motores, cabina de piloto, sistemas de seguridad. Estructura idÃ©ntica en los 100 aviones.
    * ğŸ¨ **Las Configuraciones del diseÃ±o (Sections)**

    + 70 aviones: configuraciÃ³n econÃ³mica estÃ¡ndar
    + 20 aviones: configuraciÃ³n business con asientos premium
    + 10 aviones: configuraciÃ³n VIP con suite privada
    + El diseÃ±o base tiene zonas marcadas "CONFIGURACIÃ“N CABINA - PERSONALIZAR" â†’ secciÃ³n `@section('cabina')`

    **Â¡El Layout es el diseÃ±o base del aviÃ³n, las secciones son las partes configurables segÃºn el cliente!**

---

## 4.1. Herencia de Plantillas con Blade

La herencia de plantillas es una de las caracterÃ­sticas mÃ¡s potentes de Blade. Permite crear un layout base que define la estructura comÃºn de todas las pÃ¡ginas, y luego extender ese layout en pÃ¡ginas especÃ­ficas.

Herencia de Plantillas en Blade



```mermaid
graph TB
   subgraph Layout["ğŸ—ï¸ LAYOUT BASE: app.blade.php"]
       direction LR
       H((Header)) --- N((Nav)) --- Y((Main (Cambioa))) --- F((Footer))
   end
   
   Layout --> V1[ğŸ“„ PÃGINA LISTADO PRODUCTOS<br/>products/index.blade.php<br/>â”â”â”â”â”â”â”â”â”â”â”<br/>Header heredado<br/>Nav heredado<br/><b>â• Tabla de productos</b><br/>Footer heredado]
   
   Layout --> V2[ğŸ“„ PÃGINA CATEGORÃAS<br/>categories/index.blade.php<br/>â”â”â”â”â”â”â”â”â”â”â”<br/>Header heredado<br/>Nav heredado<br/><b>â• Lista categorÃ­as</b><br/>Footer heredado]
   
   V1 -.reutiliza tabla.-> V3[ğŸ“„ PÃGINA INVENTARIO<br/>products/inventory.blade.php<br/>â”â”â”â”â”â”â”â”â”â”â”<br/>Header heredado<br/>Nav heredado<br/><b>â• Tabla productos</b><br/><b>â• Columna Stock/Cantidad</b><br/>Footer heredado]
   
   style Layout fill:#fff9c4,stroke:#f57f17,stroke-width:3px
   style V1 fill:#bbdefb,stroke:#1976d2,stroke-width:2px
   style V2 fill:#bbdefb,stroke:#1976d2,stroke-width:2px
   style V3 fill:#c8e6c9,stroke:#388e3c,stroke-width:2px
   style H fill:#ffeb3b
   style N fill:#ffeb3b
   style Y fill:#ffeb3b
   style F fill:#ffeb3b
```

## 4.2. Directivas de Herencia

### 4.2.1. Directivas `@extends` y `@section`

La directiva `@extends` especifica quÃ© layout debe usar una vista. Debe ser la primera lÃ­nea del archivo.

La directiva `@section` define bloques de contenido que se insertan en el layout. Cada secciÃ³n tiene un nombre Ãºnico.



```html
<!-- resources/views/products/show.blade.php -->
@extends('layouts.app')

@section('title') <!-- TÃ­tulo dinÃ¡mico -->
    Mi TÃ­tulo
@endsection

@section('content')                      <!-- Contenido dinÃ¡mico -->
    <h1>{{ $product->name }}</h1>
    <p>{{ $product->description }}</p>
    <p>Precio: {{ $product->price }}â‚¬</p>
@endsection
```

#### Sintaxis Corta para Secciones

Para secciones de una sola lÃ­nea, se puede usar la sintaxis corta:



```html
@section('title')
    Mi TÃ­tulo
@endsection

<!-- Equivale a: -->

@section('title', 'Mi TÃ­tulo')
```

### 4.2.2. Directiva `@yield`

En el layout, definimos secciones con `@yield` que se rellenaran con las secciones definidas en las vistas hijas usando `@section`:



```html
<!-- resources/views/layouts/app.blade.php -->
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="utf-8">
    <title>@yield('title', 'Mi AplicaciÃ³n')</title> <!-- TÃ­tulo dinÃ¡mico -->
</head>
<body>
    <header>
        <nav>
            <!-- NavegaciÃ³n comÃºn -->
        </nav>
    </header>

    <main>
        @yield('content') <!-- Contenido dinÃ¡mico -->
    </main>

    <footer>
        <!-- Footer comÃºn -->
    </footer>
</body>
</html>
```

## 4.3. Directivas Avanzadas

### 4.3.1. Directiva `@parent`

La directiva `@parent` permite incluir el contenido de la secciÃ³n padre en una secciÃ³n que la estÃ¡ sobrescribiendo:



```html
<!-- resources/views/products/show.blade.php -->
@extends('products.show')

@section('title') <!-- TÃ­tulo dinÃ¡mico -->
    Mi TÃ­tulo 2
@endsection

@section('sidebar')
    @parent
    <p>Cantidad: {{ $product->quantity }}â‚¬</p>
@endsection
```

## 4.4. Stacks de Blade

### 4.4.1. Directiva `@push` y `@stack`
Los **stacks** (pilas) son contenedores donde mÃºltiples vistas pueden **acumular** contenido que luego se renderiza en un punto especÃ­fico del layout.

???+examplelaravel "AnalogÃ­a: Oficina de Objetos Perdidos del Aeropuerto"

    **Imagina la oficina de objetos perdidos de un aeropuerto internacional:**

    * âœˆï¸ **Vuelo LV742 (Vista Productos)**: Los pasajeros olvidan gafas de sol, auriculares y portÃ¡tiles
    * âœˆï¸ **Vuelo IB531 (Vista CategorÃ­as)**: Los pasajeros olvidan libros, paraguas y chaquetas
    * âœˆï¸ **Vuelo BA890 (Vista Carrito)**: Los pasajeros olvidan tablets y mochilas
    * ğŸ“¦ **Oficina de Objetos Perdidos (@stack)**: AlmacÃ©n donde se **acumulan TODOS** los objetos de **TODOS** los vuelos sin excepciÃ³n
    * ğŸ·ï¸ **Cada vuelo entrega (@push)**: Cada aviÃ³n deposita sus objetos perdidos, se suman a los existentes.
    * ğŸ **Al final del dÃ­a (@stack renderiza)**: La estanterÃ­a muestra TODOS los objetos acumulados de TODOS los vuelos

    **Â¡Con `@section` solo queda el Ãºltimo objeto (sobrescritura). Con `@stack` se acumulan TODOS los objetos de TODOS los vuelos!**

### 4.4.2. Ejemplo Progresivo: Vista de Producto

#### Paso 1: Layout base con stacks definidos



```html
<!-- resources/views/layouts/app.blade.php -->
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="utf-8">
    <title>@yield('title', 'Mi Tienda')</title>
    
    <!-- CSS comÃºn cargado SIEMPRE -->
    <link rel="stylesheet" href="/css/app.css">
    
    <!-- Stack para CSS especÃ­fico de cada pÃ¡gina -->
    @stack('styles')
</head>
<body>
    <header>
        <nav><!-- NavegaciÃ³n comÃºn --></nav>
    </header>

    <main>
        @yield('content')
    </main>

    <footer><!-- Footer comÃºn --></footer>
    
    <!-- JavaScript comÃºn cargado SIEMPRE -->
    <script src="/js/app.js"></script>
    
    <!-- Stack para JavaScript especÃ­fico de cada pÃ¡gina -->
    @stack('scripts')
</body>
</html>
```

#### Paso 2: Vista de producto que aÃ±ade recursos especÃ­ficos



```html
<!-- resources/views/products/show.blade.php -->
@extends('layouts.app')

@section('title', $product->name)

<!-- PUSH #1: AÃ±ade CSS especÃ­fico de productos -->
@push('styles')
    <link rel="stylesheet" href="/css/products.css">
@endpush

@section('content')
    <article class="product-card">
        <!-- Detalles del producto -->
    </article>
@endsection

<!-- PUSH #2: AÃ±ade JavaScript especÃ­fico de productos -->
@push('scripts')
    <!-- LibrerÃ­a externa para la galerÃ­a de imÃ¡genes -->
    <script src="https://cdn.example.com/image-gallery.js"></script>
    
    <!-- Script especÃ­fico de productos -->
    <script src="/js/products.js"></script>
@endpush
```

#### Paso 3: HTML final generado (lo que ve el navegador)



```html
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="utf-8">
    <title>PortÃ¡til HP 15</title>
    
    <!-- CSS comÃºn (del layout) -->
    <link rel="stylesheet" href="/css/app.css">
    
    <!-- â¬‡ï¸ TODO EL CONTENIDO DEL STACK 'styles' SE RENDERIZA AQUÃ â¬‡ï¸ -->
    <link rel="stylesheet" href="/css/products.css">
    <!-- â¬†ï¸ FIN DEL STACK 'styles' â¬†ï¸ -->
</head>
<body>
    <header>
        <nav><!-- NavegaciÃ³n comÃºn --></nav>
    </header>

    <main>
        <article class="product-card">
            <!-- Detalles del producto -->
        </article>
    </main>

    <footer><!-- Footer comÃºn --></footer>
    
    <!-- JavaScript comÃºn (del layout) -->
    <script src="/js/app.js"></script>
    
    <!-- â¬‡ï¸ TODO EL CONTENIDO DEL STACK 'scripts' SE RENDERIZA AQUÃ â¬‡ï¸ -->
    <script src="https://cdn.example.com/image-gallery.js"></script>
    <script src="/js/products.js"></script>
    <!-- â¬†ï¸ FIN DEL STACK 'scripts' â¬†ï¸ -->
</body>
</html>
```

Ventajas de los Stacks

**1. Carga selectiva de recursos:**

* La pÃ¡gina de productos carga `products.css` y la librerÃ­a de galerÃ­a
* La pÃ¡gina de categorÃ­as NO carga esos recursos (solo los suyos)
* Â¡Mejor rendimiento! No cargas cÃ³digo innecesario

**2. MÃºltiples push al mismo stack:**

* Puedes hacer `@push('scripts')` varias veces en la misma vista
* Todos los push se acumulan en orden
* Ãštil cuando tienes cÃ³digo HTML mezclado con cÃ³digo Blade

**3. Sin acoplamiento:**

* El layout NO sabe quÃ© recursos necesita cada pÃ¡gina
* Cada vista declara sus propias dependencias
* FÃ¡cil aÃ±adir/quitar funcionalidades sin tocar el layout

## 4.5. Directivas de InclusiÃ³n

### 4.5.1. Directiva `@include`

La directiva `@include` permite incluir una vista dentro de otra. Es Ãºtil para componentes reutilizables que suelen ser fijos en todas las pÃ¡ginas, como barras laterales, footers, menÃºs, etc.



```html
<!-- resources/views/layouts/app.blade.php -->
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="utf-8">
    <title>@yield('title', 'Mi Tienda')</title>
</head>
<body>
    @include('partials.header') <!-- Incluye el header comÃºn -->

    <main>
        @yield('content')
    </main>

    @include('partials.footer') <!-- Incluye el footer comÃºn -->
    
</body>
</html>
```

El contenido de `partials/header.blade.php` podrÃ­a ser:



```html
<header>
    <h1>Mi Tienda</h1>
    <nav>
        <ul>
            <li><a href="/">Inicio</a></li>
            <li><a href="/products">Productos</a></li>
            <li><a href="/about">Acerca de</a></li>
            <li><a href="/contact">Contacto</a></li>
        </ul>
    </nav>
</header>
```

### 4.5.2. Pasar Variables a Includes

Se pueden pasar variables a las vistas incluidas:



```html
@include('partials.header', ['links' => $links])

<!-- O usando la sintaxis de array -->
@include('partials.header', $links)
```

### 4.5.3. Directiva `@includeIf`

Incluye una vista solo si existe:



```html
<header>
    <h1>Mi Tienda</h1>
    @includeIf('partials.nav') <!-- Incluye la navegaciÃ³n comÃºn -->
    <!-- Si 'partials.nav' no existe, no hace nada -->
</header>
```

### 4.5.4. Directiva `@includeWhen`

Incluye una vista condicionalmente:



```html
<header>
    <h1>Mi Tienda</h1>
    @includeWhen(count($links) > 0, 'partials.nav')
</header>
```
