# Introducci√≥n

## S√≠ntesis de la sesi√≥n

En esta sesi√≥n se exploran los **fundamentos arquitect√≥nicos de Laravel**. Se estudia el **ciclo de vida completo de las peticiones HTTP**, desde `index.php` hasta la respuesta final, pasando por el Service Container, middleware y el flujo de procesamiento. Se domina el **sistema de rutas y controladores RESTful**, aplicando el principio de Separaci√≥n de Responsabilidades.

Se construyen **interfaces din√°micas con Blade**: el motor de plantillas de Laravel, layouts maestros reutilizables, herencia de plantillas con directivas avanzadas (`@parent`, `@show`, `@append`), y stacks para acumulaci√≥n de contenido. Se aprende a **integrar datos en vistas** usando m√∫ltiples m√©todos (`compact()`, `with()`, View Composers), manejar datos flash, y aplicar operadores null-safe para vistas robustas.

Finalmente, se trabaja con **datos mock organizados** usando traits reutilizables (`LoadsMockData`), transformando datos con `array_map()` y `array_filter()`, y preparando la transici√≥n a base de datos real (Sesi√≥n 3). El objetivo es comprender el flujo completo request-response, crear aplicaciones MVC profesionales y dominar el patr√≥n de ejemplos progresivos (Layout ‚Üí Vista ‚Üí HTML final).

## Contenidos de la Sesi√≥n 2

1. **Ciclo de Vida de las Peticiones HTTP**: Se estudia el viaje completo de una petici√≥n HTTP en Laravel: desde `index.php` hasta la respuesta final. Se explora el rol del middleware, el Service Container, y c√≥mo cada componente procesa la petici√≥n en el framework.
2. **Sistema de Rutas y Controladores**: Se domina el enrutamiento de Laravel para gestionar las peticiones web. Se aprende a definir rutas (`web.php`, `api.php`), manejar par√°metros din√°micos, crear controladores resource, aplicar middleware y organizar c√≥digo profesionalmente.
3. **Introducci√≥n a Blade**: Se descubre el motor de plantillas Blade de Laravel para generar HTML din√°mico. Se aprende sintaxis de escapado ( vs `{!! !!}`), directivas de control de flujo (`@if`, `@foreach`, `@empty`), la variable `$loop`, directivas de autenticaci√≥n y formularios para crear vistas din√°micas seguras.
4. **Layouts y Herencia en Blade**: Se construyen layouts maestros reutilizables para estructurar las aplicaciones. Se domina la herencia con `@extends`, `@section`, `@yield`, directivas avanzadas (`@parent`, `@show`, `@append`), stacks para acumulaci√≥n de contenido (`@push`/`@stack`), y layouts anidados para arquitecturas complejas.
5. **Integraci√≥n de Datos con Vistas**: Se conectan controladores con vistas para crear interfaces din√°micas. Se aprenden m√©todos de paso de datos (`view([])`, `with()`, `compact()`), redirecci√≥n con datos flash, ejemplos completos controlador‚Üívista‚ÜíHTML, View Composers para datos compartidos, y buenas pr√°cticas de separaci√≥n de responsabilidades.
6. **Datos Mock para Desarrollo**: Se aprende a trabajar con datos mock para desarrollo sin base de datos real. Se organizan datos en `database/data/`, se crean traits reutilizables (`LoadsMockData`), se transforman datos con `array_map()` y `array_filter()`, y se prepara la transici√≥n a base de datos real en Sesi√≥n 3.


## Objetivos de la Sesi√≥n 2

Acceso R√°pido a los Objetivos

* **Objetivo 1**: Comprender el ciclo de vida completo de las peticiones HTTP en Laravel: desde `index.php`, pasando por el Service Container y middleware, hasta la respuesta final renderizada.
* **Objetivo 2**: Dominar el sistema de rutas y controladores RESTful, organizando c√≥digo con el principio de Separaci√≥n de Responsabilidades, aplicando middleware y creando controladores resource profesionales.
* **Objetivo 3**: Dominar el motor de plantillas Blade con sintaxis de escapado seguro ( vs `{!! !!}`), directivas de control de flujo, autenticaci√≥n, formularios y la variable `$loop` para HTML din√°mico.
* **Objetivo 4**: Construir layouts maestros reutilizables con herencia de plantillas (`@extends`, `@section`, `@yield`), directivas avanzadas (`@parent`, `@show`, `@append`), stacks y layouts anidados.
* **Objetivo 5**: Integrar datos en vistas usando m√∫ltiples m√©todos (`view([])`, `with()`, `compact()`), manejar datos flash, implementar View Composers para datos compartidos y aplicar operadores null-safe.
* **Objetivo 6**: Trabajar con datos mock organizados usando traits reutilizables (`LoadsMockData`), transformar datos con `array_map()` y `array_filter()`, y preparar la transici√≥n a base de datos real.
* **Objetivo 7**: Aplicar el patr√≥n de ejemplos progresivos (Layout ‚Üí Vista ‚Üí HTML final) para comprender la integraci√≥n completa de componentes Blade.
* **Objetivo 8**: Seguir buenas pr√°cticas Laravel: separaci√≥n de responsabilidades, nomenclatura consistente, seguridad CSRF, validaci√≥n y preparaci√≥n para escalabilidad.

---

|Objetivos Generales del Curso | Objetivos de la Sesi√≥n 2 |
| --- | --- |
| **Objetivo General 2** | **Objetivo 1**: Comprender el ciclo de vida de peticiones HTTP |
| **Objetivo General 2** | **Objetivo 2**: Dominar enrutamiento y controladores RESTful |
| **Objetivo General 2** | **Objetivo 3**: Dominar el motor Blade con directivas completas |
| **Objetivo General 2** | **Objetivo 4**: Construir layouts y directivas avanzadas |
| **Objetivo General 2** | **Objetivo 5**: Integrar datos con View Composers y buenas pr√°cticas |
| **Objetivo General 2** | **Objetivo 6**: Trabajar con datos mock y traits reutilizables |
| **Objetivo General 2** | **Objetivo 7**: Aplicar patr√≥n de ejemplos progresivos |
| **Objetivo General 2** | **Objetivo 8**: Seguir buenas pr√°cticas Laravel |

## Recursos Adicionales

### **Documentaci√≥n Oficial**

* [Laravel 12.x Documentation](https://laravel.com/docs/12.x){:target="_blank"} - Documentaci√≥n oficial completa
* [Laravel Routing](https://laravel.com/docs/12.x/routing){:target="_blank"} - Gu√≠a oficial de enrutamiento
* [Laravel Blade Templates](https://laravel.com/docs/12.x/blade){:target="_blank"} - Documentaci√≥n oficial de Blade

### **Fundamentos Web**

* [MDN Web Docs - HTTP](https://developer.mozilla.org/en-US/docs/Web/HTTP){:target="_blank"} - Documentaci√≥n completa sobre HTTP
* [PHP.net - Controllers](https://www.php.net/manual/en/language.oop5.php){:target="_blank"} - Conceptos de controladores en PHP
* [Blade Template Engine](https://laravel.com/docs/12.x/blade){:target="_blank"} - Motor de plantillas Blade

### **Recursos de Aprendizaje**

* [Laracasts](https://laracasts.com){:target="_blank"} - Tutoriales en video de Laravel
* [Laravel News](https://laravel-news.com){:target="_blank"} - Noticias y art√≠culos sobre Laravel
* [Laravel Daily](https://laraveldaily.com){:target="_blank"} - Tips y tutoriales diarios de Laravel


???teolaravel "Glosario T√©cnico"
	| T√©rmino | Definici√≥n |
	| --- | --- |
	| **array\_filter()** | Funci√≥n PHP que filtra elementos de un array seg√∫n una condici√≥n booleana y devuelve solo los que cumplen. |
	| **array\_map()** | Funci√≥n PHP que aplica una transformaci√≥n a cada elemento de un array y devuelve un nuevo array transformado. |
	| **Blade** | Motor de plantillas de Laravel con sintaxis elegante (, `@if`, `@foreach`) que compila a PHP puro. |
	| **compact()** | Funci√≥n PHP que convierte variables en array asociativo para pasarlas a vistas (`compact('productos', 'usuario')`). |
	| **Controlador** | Clase que maneja la l√≥gica de negocio y coordina entre modelos y vistas, devolviendo respuestas HTTP. |
	| **Controlador Resource** | Controlador que implementa las 7 acciones RESTful est√°ndar (index, create, store, show, edit, update, destroy). |
	| **Datos Mock** | Datos de prueba simulados en archivos PHP (`database/data/`) para desarrollo sin base de datos real. |
	| **Directiva Blade** | Instrucci√≥n especial de Blade (`@if`, `@foreach`, `@auth`, `@csrf`, etc.) que controla el flujo y la l√≥gica en plantillas. |
	| **Herencia de Plantillas** | Mecanismo Blade (`@extends`, `@section`, `@yield`) que permite que vistas hijas extiendan layouts padres. |
	| **Layout** | Plantilla maestra que define la estructura com√∫n (header, footer, scripts) de m√∫ltiples p√°ginas de una aplicaci√≥n. |
	| **Middleware** | Capa de software que filtra/procesa las peticiones HTTP antes de llegar a los controladores (autenticaci√≥n, CORS, etc.). |
	| **Operador Null-Safe** | Operador `?.` de PHP que evita errores al acceder a propiedades/m√©todos de objetos potencialmente nulos. |
	| **Ruta** | Definici√≥n en `web.php` o `api.php` que especifica c√≥mo una URL debe ser manejada por la aplicaci√≥n Laravel. |
	| **Secci√≥n** | √Årea definida con `@section`/`@yield` en un layout que puede ser sobrescrita (`@show`), a√±adida (`@append`) o modificada por vistas hijas. |
	| **Service Container** | Contenedor de dependencias que gestiona la creaci√≥n y resoluci√≥n autom√°tica de objetos en Laravel (IoC Container). |
	| **Stack** | Mecanismo Blade (`@push`, `@stack`) para acumular contenido (scripts, estilos) desde m√∫ltiples vistas en un layout. |
	| **Trait** | Mecanismo PHP de reutilizaci√≥n de c√≥digo horizontal que permite compartir m√©todos entre clases sin herencia. |
	| **View Composer** | Clase que inyecta datos autom√°ticamente en vistas espec√≠ficas sin repetir c√≥digo en controladores. |
	| **View::share()** | M√©todo para compartir datos globalmente con todas las vistas de la aplicaci√≥n. |



???teolaravel "FAQ (Preguntas Frecuentes sobre la Pr√°ctica)"
	- ==**P: Error "Target class [NombreController] does not exist" al acceder a una ruta**==
		+ **R:** Verifica los siguientes pasos:
			1. El controlador existe en `app/Http/Controllers/`
			2. El nombre del archivo y la clase coinciden exactamente (sensible a may√∫sculas)
			3. El namespace es correcto (`namespace App\Http\Controllers;`)
			4. Ejecuta `sail artisan route:clear` para limpiar cach√© de rutas
			5. Verifica que importaste el controlador en `web.php` con `use App\Http\Controllers\NombreController;`
	- ==**P: Error "View [nombre-vista] not found" al cargar una p√°gina**==
		+ **R:** Verifica los siguientes pasos:
			1. El archivo existe en `resources/views/` con extensi√≥n `.blade.php`
			2. La ruta es correcta (Laravel usa punto para subdirectorios: `categories.show` = `resources/views/categories/show.blade.php`)
			3. El nombre del archivo no tiene may√∫sculas (Laravel es case-sensitive en Linux/Docker
			4. Ejecuta `sail artisan view:clear` para limpiar cach√©
	- ==**P: Los datos mock devuelven "Undefined array key" o valores nulos**==
		+ **R:** Verifica los siguientes pasos:
			1. Los archivos mock existen en `database/data/` y devuelven un array con `return [...]`
			2. Las claves del array coinciden con los IDs que buscas
			3. En el Trait `LoadsMockData` la ruta del `require` es correcta (`database_path('data/mock-products.php')`)
			4. El m√©todo `enrichProductsWithOffers()` se llama antes de pasar datos a la vista
	- ==**P: El m√©todo `enrichProductsWithOffers()` no funciona o muestra datos incorrectos**==
		+ **R:** Este m√©todo debe cumplir los siguientes pasos:
			1. Cargar ofertas primero con `$this->loadOffers()`
			2. Usar `array_map()` para transformar cada producto
			3. Buscar la oferta en el array de ofertas por `$product['offer_id']`
			4. Calcular `final_price` correctamente: `price * (1 - discount_percentage / 100)`
			5. Verifica que los `offer_id` en productos coincidan con IDs reales en `mock-offers.php`
	- ==**P: Error "Call to undefined method" al usar el Trait LoadsMockData**==
		+ **R:** Verifica los siguientes pasos:
			1. El Trait est√° declarado en el controlador con `use LoadsMockData;` (dentro de la clase)
			2. El namespace del Trait es correcto (`namespace App\Traits;`)
			3. Importaste el Trait en el controlador con `use App\Traits\LoadsMockData;` (fuera de la clase)
			4. El m√©todo que llamas existe en el Trait (revisa may√∫sculas/min√∫sculas)
	- ==**P: Los componentes Blade (`ProductCard`, `CategoryCard`) no se muestran o dan error**==
		+ **R:** Verifica los siguientes pasos:
			1. Creaste ambos archivos: clase en `app/View/Components/` y vista en `resources/views/components/`
			2. Los nombres coinciden (PascalCase en clase, kebab-case en vista: `ProductCard.php` ‚Üí `product-card.blade.php`)
			3. La clase extiende `Component` y tiene el m√©todo `render()`
			4. Las props (`$product`, `$category`) est√°n definidas en el constructor
			5. Ejecuta `sail artisan view:clear` para limpiar cach√©
	- ==**P: El layout `app.blade.php` no carga los partials (header, footer, navigation)**==
		+ **R:** Verifica los siguientes pasos:
			1. Los partials existen en `resources/views/partials/` con extensi√≥n `.blade.php`
			2. La sintaxis de inclusi√≥n es correcta: `@include('partials.header')` (punto, no barra)
			3. No hay errores de sintaxis en los partials (un error en un partial rompe toda la p√°gina)
			4. Los partials devuelven HTML v√°lido
	- ==**P: Error 404 "Page not found" al acceder a rutas que defin√≠ en `web.php`**==
		+ **R:** Verifica los siguientes pasos:
			1. La ruta est√° correctamente definida en `routes/web.php`
			2. La URL coincide exactamente (revisa par√°metros: `/products/{id}` requiere un ID num√©rico)
			3. Ejecuta `sail artisan route:list` para ver todas las rutas disponibles
			4. El nombre de la ruta es correcto si usas `route('nombre')`
			5. Limpia cach√© con `sail artisan route:clear`
	- ==**P: Los estilos de Tailwind no se aplican en las nuevas vistas**==
		+ **R:** Verifica los siguientes pasos:
			1. El layout `app.blade.php` incluye `@vite(['resources/css/app.css'])`
			2. Las vistas hijas extienden el layout con `@extends('layouts.app')`
			3. Ejecutaste `sail npm run build` o `sail npm run dev` despu√©s de crear nuevas vistas
			4. Las clases de Tailwind est√°n escritas correctamente (sin espacios: `bg-blue-500`, no `bg-blue - 500`)
	- ==**P: Error "Trying to access array offset on value of type null" en las vistas**==
		+ **R:** Usa operadores null-safe siguiendo estos pasos:
			1. Para arrays: `$product['offer'] ?? null`
			2. Para objetos: `$user?->name`
			3. En Blade: `@isset($variable)` antes de usarla
			4. Verifica que el controlador est√° pasando todos los datos necesarios con `dd($datos)`
	- ==**P: La navegaci√≥n no resalta el enlace activo correctamente**==
		+ **R:** Verifica los siguientes pasos:
			1. Las rutas tienen nombres asignados con `->name('nombre.ruta')`
			2. En `navigation.blade.php` usas `Route::is('nombre.ruta')` o `request()->routeIs('nombre.ruta')`
			3. Los nombres de ruta coinciden exactamente (sensible a may√∫sculas)
			4. Para rutas con par√°metros usa wildcards: `Route::is('products.*')`
	- ==**P: Error "Route [nombre.ruta] not defined" al usar `route()` en vistas**==
		+ **R:** Verifica los siguientes pasos:
			1. La ruta tiene nombre asignado en `web.php` con `->name('nombre.ruta')`
			2. El nombre no tiene errores tipogr√°ficos
			3. Ejecuta `sail artisan route:list` para ver todas las rutas con nombres
			4. Limpia cach√© con `sail artisan route:clear` y `sail artisan config:clear`
	- ==**P: Los productos no muestran el precio con descuento aplicado**==
		+ **R:** Verifica los siguientes pasos:
			1. Est√°s llamando `enrichProductsWithOffers()` en el controlador ANTES de pasar datos a la vista
			2. El producto tiene un `offer_id` v√°lido en `mock-products.php`
			3. La oferta existe en `mock-offers.php` con ese ID
			4. El c√°lculo es correcto: `final_price = price * (1 - discount_percentage / 100)`
			5. Usas `$product['final_price']` en la vista, no calculas all√≠
	- ==**P: ¬øC√≥mo depuro qu√© datos est√° recibiendo mi vista?**==
		+ **R:** Usa estas t√©cnicas de depuraci√≥n:
			1. En el controlador: `dd($productos)` antes de `return view()` para ver datos
			2. En la vista: `{{ dd($productos) }}` o `@dump($productos)` para inspeccionar
			3. Laravel Telescope ‚Üí Requests ‚Üí Ver datos pasados a la vista
			4. Navegador ‚Üí Ver c√≥digo fuente para verificar HTML generado

## üèÜ Hitos a Conseguir

> Al completar esta sesi√≥n, habr√°s creado una **aplicaci√≥n web din√°mica con Laravel** que incluya:
>
> * Sistema de rutas RESTful organizadas en `web.php` y `api.php`
> * Controladores resource profesionales con separaci√≥n de responsabilidades
> * Layouts maestros Blade con herencia, directivas avanzadas y stacks
> * Integraci√≥n de datos usando View Composers y m√∫ltiples m√©todos
> * Datos mock organizados con traits reutilizables
> * Aplicaci√≥n completa del patr√≥n MVC
> * Comprensi√≥n profunda del ciclo de vida de peticiones HTTP
> * Buenas pr√°cticas de seguridad (CSRF, escapado, validaci√≥n)
>
> **Resultado:** Una aplicaci√≥n web funcional lista para escalar a base de datos real en Sesi√≥n 3.
