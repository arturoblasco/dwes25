# 2.4. Layouts y herencia en Blade
Los layouts son la columna vertebral de cualquier aplicaci√≥n web profesional, permitiendo mantener una estructura visual consistente y realizar cambios globales desde un √∫nico punto de control.

**¬øPor qu√© son esenciales los layouts?** En aplicaciones reales, todas las p√°ginas comparten elementos estructurales comunes: la barra de navegaci√≥n, el footer, los enlaces a hojas de estilo CSS y scripts JavaScript, los meta tags de SEO. Sin un sistema de layouts, cambiar algo tan simple como el logo de la empresa requerir√≠a editar manualmente cientos de archivos individuales.

Los layouts eliminan esta pesadilla, centralizando la estructura com√∫n y permitiendo que cada p√°gina se enfoque √∫nicamente en su contenido espec√≠fico.

???examplelaravel "Analog√≠a: F√°brica de Aviones con 100 Unidades del Mismo Modelo"

    **Imagina que Boeing fabrica 100 aviones del modelo 737.**

    * ‚úàÔ∏è **El Dise√±o Base (Layout)** Todos tienen: fuselaje, alas, motores, cabina de piloto, sistemas de seguridad. Estructura id√©ntica en los 100 aviones.
    * üé® **Las Configuraciones del dise√±o (Sections)**

    + 70 aviones: configuraci√≥n econ√≥mica est√°ndar
    + 20 aviones: configuraci√≥n business con asientos premium
    + 10 aviones: configuraci√≥n VIP con suite privada
    + El dise√±o base tiene zonas marcadas "CONFIGURACI√ìN CABINA - PERSONALIZAR" ‚Üí secci√≥n `@section('cabina')`

    **¬°El Layout es el dise√±o base del avi√≥n, las secciones son las partes configurables seg√∫n el cliente!**


La herencia de plantillas es una de las caracter√≠sticas m√°s potentes de Blade. Permite crear un layout base que define la estructura com√∫n de todas las p√°ginas, y luego extender ese layout en p√°ginas espec√≠ficas.

---


## 1. Directivas de herencia

### 1.1. Directiva `@yield`

En el layout, definimos secciones con **`@yield`** que se rellenaran con las secciones definidas en las vistas hijas usando **`@section`**:

```html
<!-- resources/views/layouts/app.blade.php -->
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="utf-8">
    <title>@yield('title', 'Mi Aplicaci√≥n')</title> <!-- T√≠tulo din√°mico -->
</head>
<body>
    <header>
        <nav>
            <!-- Navegaci√≥n com√∫n -->
        </nav>
    </header>

    <main>
        @yield('content') <!-- Contenido din√°mico -->
    </main>

    <footer>
        <!-- Footer com√∫n -->
    </footer>
</body>
</html>
```

### 1.2. Directivas `@extends` y `@section`

La directiva **`@extends`** especifica qu√© layout debe usar una vista. Debe ser la primera l√≠nea del archivo.

La directiva **`@section`** define bloques de contenido que se insertan en el layout. Cada secci√≥n tiene un nombre √∫nico.

```html
<!-- resources/views/products/show.blade.php -->
@extends('layouts.app')

@section('title', 'Mi T√≠tulo') <!-- T√≠tulo din√°mico -->

@section('content')            <!-- Contenido din√°mico -->
    <h1>{{ $product->name }}</h1>
    <p>{{ $product->description }}</p>
    <p>Precio: {{ $product->price }}‚Ç¨</p>
@endsection
```


## 2. Directivas avanzadas

### 2.1. Directiva `@parent`

La directiva **`@parent`** permite incluir el contenido de la secci√≥n padre en una secci√≥n que la est√° sobrescribiendo:

```html
<!-- resources/views/products/show.blade.php -->
@extends('products.show')

@section('title') <!-- T√≠tulo din√°mico -->
    Mi T√≠tulo 2
@endsection

@section('sidebar')
    @parent
    <p>Cantidad: {{ $product->quantity }}‚Ç¨</p>
@endsection
```

## 3. Stacks de Blade

### 3.1. Directiva `@push` y `@stack`
Los **stacks** (pilas) son contenedores donde m√∫ltiples vistas pueden **acumular** contenido que luego se renderiza en un punto espec√≠fico del layout.

???examplelaravel "Analog√≠a: Oficina de Objetos Perdidos del Aeropuerto"

    **Imagina la oficina de objetos perdidos de un aeropuerto internacional:**

    * ‚úàÔ∏è **Vuelo LV742 (Vista Productos)**: Los pasajeros olvidan gafas de sol, auriculares y port√°tiles
    * ‚úàÔ∏è **Vuelo IB531 (Vista Categor√≠as)**: Los pasajeros olvidan libros, paraguas y chaquetas
    * ‚úàÔ∏è **Vuelo BA890 (Vista Carrito)**: Los pasajeros olvidan tablets y mochilas
    * üì¶ **Oficina de Objetos Perdidos (@stack)**: Almac√©n donde se **acumulan TODOS** los objetos de **TODOS** los vuelos sin excepci√≥n
    * üè∑Ô∏è **Cada vuelo entrega (@push)**: Cada avi√≥n deposita sus objetos perdidos, se suman a los existentes.
    * üéÅ **Al final del d√≠a (@stack renderiza)**: La estanter√≠a muestra TODOS los objetos acumulados de TODOS los vuelos

    **¬°Con `@section` solo queda el √∫ltimo objeto (sobrescritura). Con `@stack` se acumulan TODOS los objetos de TODOS los vuelos!**

### 3.2. Ejemplo progresivo: vista de Producto

#### Paso 1: Layout base con stacks definidos

```html
<!-- resources/views/layouts/app.blade.php -->
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="utf-8">
    <title>@yield('title', 'Mi Tienda')</title>
    
    <!-- CSS com√∫n cargado SIEMPRE -->
    <link rel="stylesheet" href="/css/app.css">
    
    <!-- Stack para CSS espec√≠fico de cada p√°gina -->
    @stack('styles')
</head>
<body>
    <header>
        <nav><!-- Navegaci√≥n com√∫n --></nav>
    </header>

    <main>
        @yield('content')
    </main>

    <footer><!-- Footer com√∫n --></footer>
    
    <!-- JavaScript com√∫n cargado SIEMPRE -->
    <script src="/js/app.js"></script>
    
    <!-- Stack para JavaScript espec√≠fico de cada p√°gina -->
    @stack('scripts')
</body>
</html>
```

#### Paso 2: Vista de producto que a√±ade recursos espec√≠ficos

```html
<!-- resources/views/products/show.blade.php -->
@extends('layouts.app')

@section('title', $product->name)

<!-- PUSH #1: A√±ade CSS espec√≠fico de productos -->
@push('styles')
    <link rel="stylesheet" href="/css/products.css">
@endpush

@section('content')
    <article class="product-card">
        <!-- Detalles del producto -->
    </article>
@endsection

<!-- PUSH #2: A√±ade JavaScript espec√≠fico de productos -->
@push('scripts')
    <!-- Librer√≠a externa para la galer√≠a de im√°genes -->
    <script src="https://cdn.example.com/image-gallery.js"></script>
    
    <!-- Script espec√≠fico de productos -->
    <script src="/js/products.js"></script>
@endpush
```

#### Paso 3: HTML final generado (lo que ve el navegador)

```html
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="utf-8">
    <title>Port√°til HP 15</title>
    
    <!-- CSS com√∫n (del layout) -->
    <link rel="stylesheet" href="/css/app.css">
    
    <!-- ‚¨áÔ∏è TODO EL CONTENIDO DEL STACK 'styles' SE RENDERIZA AQU√ç ‚¨áÔ∏è -->
    <link rel="stylesheet" href="/css/products.css">
    <!-- ‚¨ÜÔ∏è FIN DEL STACK 'styles' ‚¨ÜÔ∏è -->
</head>
<body>
    <header>
        <nav><!-- Navegaci√≥n com√∫n --></nav>
    </header>

    <main>
        <article class="product-card">
            <!-- Detalles del producto -->
        </article>
    </main>

    <footer><!-- Footer com√∫n --></footer>
    
    <!-- JavaScript com√∫n (del layout) -->
    <script src="/js/app.js"></script>
    
    <!-- ‚¨áÔ∏è TODO EL CONTENIDO DEL STACK 'scripts' SE RENDERIZA AQU√ç ‚¨áÔ∏è -->
    <script src="https://cdn.example.com/image-gallery.js"></script>
    <script src="/js/products.js"></script>
    <!-- ‚¨ÜÔ∏è FIN DEL STACK 'scripts' ‚¨ÜÔ∏è -->
</body>
</html>
```

**Ventajas de los Stacks**

**üí°1. Carga selectiva de recursos:**

* La p√°gina de productos carga `products.css` y la librer√≠a de galer√≠a.
* La p√°gina de categor√≠as NO carga esos recursos (solo los suyos).
* ¬°Mejor rendimiento! No cargas c√≥digo innecesario.

**üí°2. M√∫ltiples push al mismo stack:**

* Puedes hacer `@push('scripts')` varias veces en la misma vista.
* Todos los push se acumulan en orden.
* √ötil cuando tienes c√≥digo HTML mezclado con c√≥digo Blade.

**üí°3. Sin acoplamiento:**

* El layout NO sabe qu√© recursos necesita cada p√°gina.
* Cada vista declara sus propias dependencias.
* F√°cil a√±adir/quitar funcionalidades sin tocar el layout.



## 4. Directivas de inclusi√≥n

### 4.1. Directiva `@include`

La directiva **`@include`** permite incluir una vista dentro de otra. Es √∫til para componentes reutilizables que suelen ser fijos en todas las p√°ginas, como barras laterales, footers, men√∫s, etc.

```html
<!-- resources/views/layouts/app.blade.php -->
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="utf-8">
    <title>@yield('title', 'Mi Tienda')</title>
</head>
<body>
    @include('partials.header') <!-- Incluye el header com√∫n -->

    <main>
        @yield('content')
    </main>

    @include('partials.footer') <!-- Incluye el footer com√∫n -->
    
</body>
</html>
```

El contenido de `partials/header.blade.php` podr√≠a ser:

```html
<header>
    <h1>Mi Tienda</h1>
    <nav>
        <ul>
            <li><a href="/">Inicio</a></li>
            <li><a href="/products">Productos</a></li>
            <li><a href="/about">Acerca de</a></li>
            <li><a href="/contact">Contacto</a></li>
        </ul>
    </nav>
</header>
```

### 4.2. Pasar variables a includes

Se pueden pasar variables a las vistas incluidas:

```html
@include('partials.header', ['links' => $links])

<!-- O usando la sintaxis de array -->
@include('partials.header', $links)
```

### 4.3. Directiva `@includeIf`

Incluye una vista solo si existe:

```html
<header>
    <h1>Mi Tienda</h1>
    @includeIf('partials.nav') <!-- Incluye la navegaci√≥n com√∫n -->
    <!-- Si 'partials.nav' no existe, no hace nada -->
</header>
```

### 4.4. Directiva `@includeWhen`

Incluye una vista condicionalmente:

```html
<header>
    <h1>Mi Tienda</h1>
    @includeWhen(count($links) > 0, 'partials.nav')
</header>
```
